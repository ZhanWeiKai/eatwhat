  ---
  📋 命令执行清单

  1️⃣ 系统更新

  apt update && apt upgrade -y
  作用：更新软件包列表并升级33个系统包
  结果：✅ 成功，下载49.7MB更新

  ---
  2️⃣ 安装基础工具

  apt install -y curl git wget ca-certificates gnupg lsb-release
  作用：安装后续需要的命令行工具
  结果：✅ 成功（这些工具大部分已经预装）

  ---
  3️⃣ 安装Docker - 添加GPG密钥

  install -m 0755 -d /etc/apt/keyrings && \
  curl -fsSL https://download.docker.com/linux/ubuntu/gpg | \
  gpg --dearmor -o /etc/apt/keyrings/docker.gpg && \
  chmod a+r /etc/apt/keyrings/docker.gpg
  作用：下载并添加Docker官方GPG密钥（用于验证软件包真实性）
  结果：✅ 成功

  ---
  4️⃣ 安装Docker - 添加APT源

  echo "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] \
  https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable" | \
  tee /etc/apt/sources.list.d/docker.list > /dev/null
  作用：将Docker软件源添加到系统的APT源列表中
  结果：✅ 成功

  ---
  5️⃣ 安装Docker Engine

  apt update && apt install -y docker-ce docker-ce-cli containerd.io \
  docker-buildx-plugin docker-compose-plugin
  作用：安装Docker引擎及相关组件
  结果：✅ 成功，安装9个包，总大小91.3MB

  ---
  6️⃣ 启动Docker服务

  systemctl start docker && systemctl enable docker && \
  systemctl status docker --no-pager
  作用：
  - 启动Docker服务
  - 设置Docker开机自启
  - 查看Docker服务状态
  结果：✅ 成功，服务状态：active (running)

  ---
  7️⃣ 检查Docker版本

  docker --version && docker compose version
  作用：验证Docker和Docker Compose是否成功安装
  结果：✅ Docker 29.1.5, Docker Compose v5.0.1

  ---
  8️⃣ 安装nvm（Node Version Manager）

  curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.40.0/install.sh | bash
  作用：安装nvm工具（用于管理多个Node.js版本）
  结果：✅ 成功，nvm安装到 /root/.nvm

  ---
  9️⃣ 安装Node.js（第一次尝试）

  export NVM_DIR="$HOME/.nvm" && \
  [ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh" && \
  nvm install --lts && nvm use --lts
  作用：加载nvm并安装最新LTS版Node.js
  结果：⚠️ 后台运行，安装未完成

  ---
  🔟 检查Node.js安装状态（多次尝试）

  # 尝试1
  timeout 10 ssh root@47.242.74.112 "export NVM_DIR=\"\$HOME/.nvm\" && \
  [ -s \"\$NVM_DIR/nvm.sh\" ] && \. \"\$NVM_DIR/nvm.sh\" && \
  node --version 2>/dev/null || echo 'Still installing...'"

  # 尝试2
  sleep 30 && ssh root@47.242.74.112 "export NVM_DIR=\"\$HOME/.nvm\" && \
  [ -s \"\$NVM_DIR/nvm.sh\" ] && \. \"\$NVM_DIR/nvm.sh\" && \
  node --version && npm --version"
  作用：检查Node.js是否安装完成
  结果：⚠️ node命令未找到（安装还在进行中）

  ---
  1️⃣1️⃣ 检查安装进程

  ps aux | grep -E 'nvm|node|npm' | grep -v grep
  作用：查看是否有Node.js相关的安装进程在运行
  结果：❌ 没有找到安装进程（之前的安装可能失败了）

  ---
  1️⃣2️⃣ 重新安装Node.js（成功）

  bash -c "source ~/.nvm/nvm.sh && \
  nvm install --lts && \
  nvm use --lts && \
  nvm alias default lts/*"
  作用：重新安装Node.js LTS并设为默认版本
  结果：✅ 成功安装 Node.js v24.13.0

  ---
  1️⃣3️⃣ 验证Node.js安装

  bash -c "source ~/.nvm/nvm.sh && node --version && npm --version"
  作用：验证Node.js和npm版本
  结果：✅ Node.js v24.13.0, npm 11.6.2

  ---
  1️⃣4️⃣ 安装Claude Code CLI

  bash -c "source ~/.nvm/nvm.sh && npm install -g @anthropic-ai/claude-code"
  作用：全局安装Claude Code CLI工具
  结果：✅ 成功，安装了3个包

  ---
  1️⃣5️⃣ 验证Claude Code CLI

  bash -c 'source ~/.nvm/nvm.sh && claude --version'
  作用：检查Claude Code CLI版本
  结果：✅ 版本 2.1.12

  ---
  1️⃣6️⃣ 检查磁盘空间（第一次）

  df -h / && echo '---' && du -sh /usr/* 2>/dev/null | sort -h | tail -10
  作用：检查根分区磁盘空间使用情况
  结果：40GB总量，已用3.3GB，可用34GB

  ---
  1️⃣7️⃣ 检查磁盘空间（详细）

  df -h
  作用：查看所有文件系统的磁盘使用情况
  结果：根分区使用率9%，空间充足

  ---
  1️⃣8️⃣ 最终系统检查

  bash -c 'source ~/.nvm/nvm.sh && \
  echo "=== 系统信息 ===" && uname -a && \
  echo "" && \
  echo "=== Docker ===" && docker --version && docker compose version && \
  echo "" && \
  echo "=== Node.js ===" && node --version && npm --version && \
  echo "" && \
  echo "=== Claude Code CLI ===" && claude --version && \
  echo "" && \
  echo "=== 磁盘空间 ===" && df -h / | tail -1'
  作用：全面检查所有已安装工具的版本和状态
  结果：✅ 所有工具正常运行

  ---
  📊 统计总结
  ┌───────────────┬──────────────────────────────────────────────────────┐
  │     类别      │                         数量                         │
  ├───────────────┼──────────────────────────────────────────────────────┤
  │ 总命令数      │ 18个                                                 │
  ├───────────────┼──────────────────────────────────────────────────────┤
  │ 成功          │ 17个 ✅                                              │
  ├───────────────┼──────────────────────────────────────────────────────┤
  │ 部分失败/重试 │ 1个 ⚠️（Node.js第一次安装，已重试成功）              │
  ├───────────────┼──────────────────────────────────────────────────────┤
  │ 总耗时        │ 约5-6分钟                                            │
  ├───────────────┼──────────────────────────────────────────────────────┤
  │ 下载总量      │ 约141MB（系统更新49.7MB + Docker 91.3MB + 少量工具） │
  └───────────────┴──────────────────────────────────────────────────────┘
  ---
  💾 磁盘使用情况

  - 安装前：系统已使用约2-3GB
  - 安装后：总计使用 3.6GB
  - 新增占用：约600-700MB
  - 剩余空间：34GB（非常充足）